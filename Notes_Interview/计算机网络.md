计算机网络机知识点

### TCP 与 UDP 各自特点及区别

> [《计算机网络》- 第 5 章 运输层](https://book.douban.com/subject/26960678/)

**UDP（User Datagram Protocol，用户数据报协议）：**

UDP 协议是面向无连接的用户数据报协议，在传输数据之前不需要先建立连接。远地主机的运输层收到UDP报文后，不需要给出任何确认。 

**TCP（Transmission Control Protocol，传输控制协议）：**

TCP 是提供面向连接的服务。在传输数据前必须先建立连接，数据传输完毕后要释放连接。 

**区别：**

- 是否面向连接：TCP 向连接，UDP 是面向无连接 
- 是否可靠：TCP 可靠，UDP 尽最大努力交付，不可靠  
- 速度：TCP 的速度慢，UDP 的速度快
- 效率：TCP 是基于连接的，速度慢，有校验等，所以传送相同的数据，要比UDP发送的包多很多
- 是否能够广播：TCP 不能，UDP 能广播
- 首部大小：TCP 20 个字节，UDP 8 个字节
- 应用场合：TCP 应用于传输大量数据及数据完整性要求高的场合，UDP 用于传输少量数据及通信实时性要求高的场合

### TCP 连接与释放（三次握手与四次挥手）

> [《计算机网络》- 第 5 章 运输层](https://book.douban.com/subject/26960678/)
>
> [简述TCP连接的建立与释放（三次握手、四次挥手）](https://www.cnblogs.com/zhuwq585/p/6138775.html)

**连接 - 三次握手**

+ 第一次握手：客户端的应用进程主动打开，并向发武器发出请求报文段。其首部中：SYN=1，seq=x。

+ 第二次握手：服务器应用进程被动打开。若同意客户端的请求，则发回确认报文，其首部中：SYN=1，ACK=1，seq=y，ack=x+1。

+ 第三次握手：客户端收到确认报文之后，通知上层应用进程连接已建立，并向服务器发出确认报文，其首部：ACK=1，seq=x+1，ack=y+1。当服务器收到客户端的确认报文之后，也通知其上层应用进程连接已建立。

![20161203203726485](assets/20161203203726485.png)

在这个过程中，通信双方的状态如图，各状态为：

+ CLOSED：关闭状态
+ LISTEN：监听状态
+ SYN-SENT：同步已发送
+ SYN-RCVD：同步收到
+ ESTABLISHED：连接已建立

**释放 - 四次挥手**

+ 第一次挥手：数据传输结束以后，客户端的应用进程发出连接释放报文段，并停止发送数据，其首部：FIN=1，seq=u。
+ 第二次挥手：服务器端收到连接释放报文段之后，发出确认报文，其首部：ack=u+1，seq=v。此时本次连接就进入了半关闭状态，客户端不再向服务器发送数据。而服务器端仍会继续发送。
+ 第三次挥手：若服务器已经没有要向客户端发送的数据，其应用进程就通知服务器释放TCP连接。这个阶段服务器所发出的最后一个报文的首部应为：FIN=1，ACK=1，seq=w，ack=u+1。
+ 第四次挥手：客户端收到连接释放报文段之后，必须发出确认：ACK=1，seq=u+1，ack=w+1。 再经过 2MSL（最长报文端寿命）后，本次 TCP 连接真正结束。

![20161203205925133](assets/20161203205925133.png)

在这个过程中，通信双方的状态如图，其中：

+ ESTABLISHED：连接建立状态
+ FIN-WAIT-1：终止等待1状态
+ FIN-WAIT-2：终止等待2状态
+ CLOSE-WAIT：关闭等待状态
+ LAST-ACK：最后确认状态
+ TIME-WAIT：时间等待状态
+ CLOSED：关闭状态

报文中重要字段说明：

+ seq（序号）：TCP连接字节流中每一个字节都会有一个编号，而本字段的值指的是本报文段所发送数据部分第一个字节的序号。
+ ack（确认号）：表示期望收到的下一个报文段数据部分的第一个字节的编号，编号为ack-1及以前的字节已经收到。
+ SYN：当本字段为1时，表示这是一个连接请求或者连接接受报文。
+ ACK：仅当本字段为1时，确认号才有效。
+ FIN：用来释放一个连接。当本字段为1时，表示此报文段的发送端数据已发送完毕，要求释放运输连接。

### HTTP

