---
title: 《图解HTTP》读书笔记
subtitle: 第04章 返回结果的HTTP状态码
author: Angus Liu
cdn: header-off
header-img: https://i.loli.net/2017/12/30/5a4755f94f1e0.jpg
date: 2017-12-30 16:35:43
tags:
      - 《图解HTTP》
      - 读书笔记
      - HTTP
---
> Life was like a box of chocolates, you never know what you’re gonna get.
> 生命就像一盒巧克力，结果往往出人意料 。
> <p align="right"> —— 罗伯特·泽米吉斯《阿甘正传》 </p>

## 4.1 状态码告知从服务器端返回的请求结果
(1) 状态码的职责是当客户端向服务器端发送请求时，描述返回的请求结果。借助状态码，用户可以知道服务器是否正常处理请求或出现的错误是什么。
(2) 状态码如200 OK，以3位数字和原因短语组成。数字中第一位指定了响应类别，后两位无分类。响应类别有以下5种：
![3d2f157b-6c88-494a-8d6a-ad4fbe6742f6](https://i.loli.net/2017/12/30/5a47515f587b2.png)

## 4.2 2XX成功
2XX的响应结果表明请求被正常处理了。
### 4.2.1 200 OK
![c25db86a-33ed-4cb0-8094-7482a3cfd23f](https://i.loli.net/2017/12/30/5a47522d6a245.png)
(1) 表示从客户端发来的请求在服务器端被正常处理了。
(2) 在响应报文中，随状态码一起返回的信息会因方法的不同而发生改变。比如，使用GET方法时，对应请求的资源的实体会作为响应返回；而使用HEAD方法时，在响应中只返回首部，不返回实体的主体部分。
### 4.2.2 204 No Content
![d5c4bbf5-fd4a-45ff-9f2c-797831a10d31](https://i.loli.net/2017/12/30/5a475255b8b31.png)
(1) 该状态码代表服务器接收的请求已成功处理，但在返回的响应报文中不含实体的主体部分。
(2) 不允许返回任何实体。比如，当浏览器发出请求处理之后，返回204响应，那么浏览器显示的页面不发生更新。
(3) 一般只需要从客户端往服务器发送信息，而对客户端不需要发送更新信息内容的情况下使用。
### 4.2.3 206 Partial Content
![902bf97b-81f6-4e33-b08e-23d2a9da508b](https://i.loli.net/2017/12/30/5a47528f0c984.jpg)
(1) 该状态码表示客户端进行了范围请求，而服务器成功执行了这部分GET请求。
(2) 响应报文中包含由Content-Range指定范围的实体内容。

## 4.3 3XX重定向
3XX响应结果表明浏览器需要执行某些特殊的处理以正确处理请求。
### 4.3.1 301 Moved Permanently
![ddc32298-9bad-4d1d-977c-b8ed3b43d443](https://i.loli.net/2017/12/30/5a4752dd52a37.jpg)
(1) 永久性重定向。该状态码表示请求的资源已被分配了新的URI，以后应使用资源现在所指的URI。也就是说，如果已经把资源对应的URI保存为书签了，这是应该按照Location首部字段提示的URI重新保存。
(2) 像下方给出的请求URI，当指定资源路径的最后忘记添加斜杠“/”，就会产生301状态码。
![e7e48062-a78b-4e0c-9204-259fc0c67c3c](https://i.loli.net/2017/12/30/5a4752f66f3d6.jpg)
### 4.3.2 302 Found
![2e03280f-6826-4225-8836-5367c45288e1](https://i.loli.net/2017/12/30/5a475317c98b6.jpg)
(1) 临时性重定向。该状态码表示请求的资源已被分配到了新的URI，希望用户（本次）能使用新的URI访问。
(2) 302和301Moved Permanently状态码相似，但302状态码代表的资源不是被永久移动，只是临时性质的。换句话说，已移动的资源对应的URI将来可能还会发生改变。比如，用户把URI保存成书签，但不会像301状态码出现时那样去更新书签，而是仍旧保存返回302状态码的页面对应的URI。
### 4.3.3 303 See Other
![aebccd07-c66f-4949-ba16-df5ffe6943ee](https://i.loli.net/2017/12/30/5a47533d3ee3e.jpg)
(1) 该状态码表示由于请求对应的资源存在着另一个URI，应使用GET方法定向获取请求的资源。
(2) 303状态码和302 Found状态码有着相同的功能，但303状态码明确表示客户端应当采用GET方法获取资源，这点与302有区别。比如， 当使用 POST 方法访问 CGI 程序， 其执行后的处理结果是希望客户端能以 GET 方法重定向到另一个 URI 上去时， 返回 303 状态码。 虽然 302 Found 状态码也可以实现相同的功能， 但这里使用303状态码是最理想的。
(3) 当301、302、303响应状态码返回时，几乎所有的浏览器都会把POST改成GET，并删除请求报文内的主体，之后请求会自动再次发送。301、302标准是禁止将POST方法改变成GET方法的，但实际使用时大家都会这么做。
### 4.3.4 304 Not Modified
![988a7faf-09bb-4fa4-b131-21ef2d48118a](https://i.loli.net/2017/12/30/5a4753ffadf03.jpg)
(1) 该状态码表示客户端发送附带条件的请求时，服务器端允许请求访问资源，但未满足条件的情况。
(2) 304状态码返回时，不包含任何响应的主体部分。
(3) 304虽然被划分在3XX类别中，但是和重定向没有关系。
(4) 附带条件的请求是指采用 GET方法的请求报文中包含 If-Match， If-ModifiedSince， If-None-Match， If-Range， If-Unmodified-Since 中任一首部。
### 4.3.4 307 Temporary Redirect
(1) 临时重定向。该状态码和302 Found有着相同的含义。
(2) 尽管302标准禁止POST变换成GET，但实际使用时大家并不遵守。307会遵照浏览器标准，不会从POST变成GET。但是，对于处理响应时的行为，每种浏览器有可能出现不同的情况。

## 4.4 4XX客户端错误
4XX的响应结果表明客户端是发生错误的原因所在。
### 4.4.1 400 Bad Request
![b4177678-2f01-4d06-9387-b96ee7f57940](https://i.loli.net/2017/12/30/5a47542df031b.jpg)
(1) 该状态码表示请求报文中存在语法错误。
(2) 当错误发生时，需修改请求的内容后再次发送请求。
(3) 浏览器会像200 OK一样对待该状态码。
### 4.4.2 401 Unauthorized
![0c8dd1ff-cd3e-4a43-b82c-60b83107c0c3](https://i.loli.net/2017/12/30/5a47544dba1e9.jpg)
(1) 该状态码表示发送的请求需要有通过HTTP认证（BASIC认证、DIGEST认证）的认证信息。
(2) 若之前已进行过1次请求，则表示用户认证失败。
(3) 返回含有401的响应必须含有一个适用于被请求资源的WWW-Authentication首部用以质询（challenge）用户信息。当浏览器初次接收到401响应，会弹出认证用的对话窗口。
### 4.4.3 403 Forbidden
![385f2638-c3b9-4bd2-9540-fb120bea8378](https://i.loli.net/2017/12/30/5a4753ddec95c.jpg)
(1) 该状态码表明对请求资源的访问被服务器拒绝了。服务器端可以在实体的主体部分对原因进行描述。
(2) 未获得文件系统的访问授权，访问权限出现某些问题（从未授权的发送源IP地址试图访问）等列举的情况都可能是发生403的原因。
### 4.4.4 404 Not Found
![87c9049c-13e6-4ff6-b44e-0ba4fabb5c06](https://i.loli.net/2017/12/30/5a47547f022d0.jpg)
(1) 该状态码表明服务器上无法找到请求的资源。
(2) 也可以在服务器拒绝请求且不想说明理由时使用。

## 4.5 5XX服务器错误
5XX的响应结果表明服务器本身发生错误。
### 4.5.1 500 Internal Server Error
![fedf6c3c-ddf4-43b6-86f0-72400e2efb9c](https://i.loli.net/2017/12/30/5a4754b34c2e4.jpg)
(1) 该状态码表明服务器在执行请求时发生了错误。
(2) 也有可能是Web应用存在的bug或某些临时的故障。
### 4.5.2 503 Service Unavailable
![08cbbdc5-81fd-44dd-862a-bf20ba281806](https://i.loli.net/2017/12/30/5a4754e1c84fc.jpg)
(1) 该状态码表明服务器暂时处于超负载或正在进行停机维护，现在无法处理请求。
(2) 如果事先得知解除以上状况需要的时间，最好写入RetryAfter首部字段返回给客户端。
(3) 状态码和状况的不一致。不少返回的状态码响应都是错误的，但是用户可能察觉不到这点。比如 Web 应用程序内部发生错误，状态码依然返回200 OK，这种情况也经常遇到。
