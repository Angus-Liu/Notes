# 《重构》在真实项目中的实践（一）

### 写在开头

选择“重构”这个庞大的主题来写第一篇公众号文章，到现在心里仍就是拿捏不定。毕竟要真正掌握它，需要大量的编码经验和项目经验云云。而这些，对于我这个刚步入职场不到一年的小白来说，门槛不是一般的高。但还是抱着“搏一搏，单车变摩托”的心态，结合自己从书中所学和实际项目经验，希望能够总结出一些对大家有用的技巧或者方法。如果这其中有一条你能够运用在后续的代码编写中，对我来说，就是莫大的鼓励和支持。

本系列文章的主题主要围绕《重构（Refactoring）》这本书进行展开，代码使用 Kotlin 语言进行描述。《重构》这本书在年前就已经看了一遍，但是很多知识点只是过了一下，没有去实践。年后的开发工作不算紧张，故而开发之余会有一些时间去思考项目代码的优化，本系列文章便是记录《重构》一书中所提到的各项技巧在团队真实项目（以 Kotlin 作为编程语言的 Web 后台项目）中的实践，计划按照《重构》每一章所讲，依据自身实践出一篇文章。

美国童子军有这样一条规则：“Leave the campground cleaner than you found it”（离开前让营地比你到来时更干净），重构的目的亦在于此。Martin Fowler 在书中这样解释“重构”：“在不改变代码外在行为的前提下，对代码做出修改，以改进程序的内部结构。重构是一种经千锤百炼形成的有条不紊的程序整理方法，可以最大限度地减少整理过程中引入错误的几率。本质上说，重构就是在代码写好之后改进它的设计”。

注意，这一句重点在于“在代码写好之后改进它的设计”，不是说颠倒黑白，先编码后设计，而是告诉大家，应该让设计贯穿代码的整个构筑过程。哪怕你不是当初打地基的人，现在给你一栋危楼，通过重构，你依然有机会将其改造成海景洋房。也许，最重要的不是掌握了什么方法，而是你有没有开始。

既然“鼓吹 ”大家去重构，那必然是有很多好处的：

- 重构能帮助你理解项目：相信大家都不是项目最初的设计者和编写者，
- 重构能避免你无端背锅：明明是调用的一个很久版本的函数，为什么会被测试测出问题
- 重构提升你的设计能力：受够了产品不断提出的需求，每次修改轻辄复制粘贴，重辄伤筋动骨
- 重构改进软件设计
- 重构使软件更容易理解
- 重构帮助找到 bug
- 重构提高编程速度

在开始重构之前，我们先来捋一捋代码的哪些征兆告诉我们项目应该开始重构了：

- 重复代码：代码复制短期看节省了开发时间，但长期必然会加剧维护的难度。DRY（Don't repeat yourself）和 Rule of three（三次原则）告诉我们，相同的代码出现两次时无关紧要，但出现第三次时就应该开始重构了。
- 过长函数：古代道家哲学就告诉我们“大道至简”，对于一个函数或是类来说，同样如此。我们不希望别人读自己写的函数到一半就已经不知道函数第一行的目的是什么了。虽然注释能帮助我们读懂代码，但请注意，注释不是除臭剂。
- 过度设计的超类：

优秀软件设计的最终目的都是奔着“高内聚低耦合”去的

并没有说函数多长才算长，不过可以以函数的职责多样性来判断。







写在最后：要学会这些技巧非常简单，只需把《重构》所讲每一章节，对照自己的项目进行改进，你就会发现有很多可以改进的地方。我真的推荐大家看一看《重构》这本书。你好，我好，他也好。



代码精进的道路路途遥远，不仅仅需要的是知识和技巧，还包括实际项目中经验的积累，目前的我也暂时只能到这了



“重构”的技巧除了从书本中获取，更多的是需要经验的积累。目前的我经验尚浅，还不足以写出更深层次的文章。因而这将会是一个持续更新的系列，我将持续输出自己对“重构”的理解和实践，多谢大家的支持。





公众号名称：我们都是爱码士、走码观花、一码平川



关于重构，很赞成Kent Beck在结尾写的话：这有点像在悬崖峭壁上的小径行走，只要有光，你就可以前进，虽然谨慎却仍然自信。但是，一旦太阳下山，你就应该停止前进；夜晚你应该睡觉，并且相信明天早晨太阳仍旧升起。